<!DOCTYPE html>
<html lang="">

<head>
	<meta charset="utf-8">
	<title>Incrément compteur like</title>
	<meta name="author" content="Your Name">
	<meta name="description" content="Example description">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="">
</head>

<body>
	<header></header>
	<main>
  <p> Fonction qui incrémente le compteur de like et ajoute le user dans le tableau dans la mesure ou le front envoir juste une valeur like entre -1 et 1 </p>
   <div id="compteur">0</div>
  	  <h3>LIKER:</h3>
	  <div id="like"></div>
	  <h3>DISLIKER:</h3>
	  <div id="dislike"></div>
	</main>
	<footer></footer>
	<script type="text/javascript">
//Fonction qui increment le compteur de like et ajoute le user dans le tableau correspondant
    let noter = document.getElementById('noter')
    let compteur = document.getElementById('compteur');
    let likeTab = document.getElementById('like');
    let disLikeTab = document.getElementById('dislike');
    //tablea fixe des Dislike
    var userDisLiked= [" jean "," paul "];
    //tableau fixe des likes
    var userLiked=["nathalie ","henri "];
    
    
    disLikeTab.innerHTML = userDisLiked;
    likeTab.innerHTML = userLiked;
//remplace la partie middleware:
    function ajoutUserIncrementLike(likes){
      
      //avis à push dans l'app correspond au req.body
      avisUserLikes.forEach(likes =>{
        for (let i =0;i<likes.length;i++){
        console.log("note de "+likes[0]+" : "+likes[1]);
        }
//partie à mettre dans le controleur
//Fonction qui incrémente le compteur de like et ajoute le user dans le tableau dans la mesure ou le front envoir juste une valeur like entre -1 et 1.
        //likes[1] étant la valeur de likes., likes[0] le userId
        if (likes[1] === 1){
          let searchUserLiked = userLiked.indexOf(likes[1],0);
          console.log("index of user : "+searchUserLiked);
          if (searchUserLiked === -1){
            userLiked.push(likes[0]);
          likeTab.innerHTML = userLiked;
          let total = Number(compteur.textContent); 
          console.log("compteur : "+total);
          total += likes[1];
          compteur.innerHTML= total;
          console.log("compteur+ : "+total);
          }else if(searchUserLiked >-1){
            
            console.log(likes[0]+" a déjà liked");
            }
          }else{
            console.log("dans else COUCOU");
            userDisLiked.push(likes[0]);
            disLikeTab.innerHTML = userDisLiked;
         }
        })
      };
        let avisUserLikes = [["sylviane ",1],[" paul ",1],[" severine ",-1],[" paul ",-1]];
      //probleme paul apparait dans les deux tableaux
    ajoutUserIncrementLike();
    
  </script>
</body>

</html>